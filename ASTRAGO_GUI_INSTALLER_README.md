# 🚀 Astrago GUI 인스톨러

## 📋 개요

Astrago GUI 인스톨러는 온라인/오프라인 환경에서 Kubernetes 클러스터와 Astrago 애플리케이션을 쉽게 설치하고 관리할 수 있는 통합 GUI 도구입니다.

## ✨ 주요 기능

### 🌐 온라인/오프라인 모드 지원
- **온라인 모드**: 인터넷을 통한 실시간 패키지 다운로드 및 설치
- **오프라인 모드**: 사전 준비된 패키지를 사용한 에어갭 환경 설치

### ☸️ Kubernetes 클러스터 관리
- 다중 노드 구성 및 관리
- 자동 인벤토리 생성
- 클러스터 설치/리셋
- GPU 드라이버 설치 지원

### 📦 Astrago 애플리케이션 관리
- 전체 애플리케이션 일괄 설치/제거
- 개별 애플리케이션 선택적 관리
- 지원 애플리케이션:
  - csi-driver-nfs
  - gpu-operator
  - gpu-process-exporter
  - loki-stack
  - prometheus
  - keycloak
  - astrago
  - harbor
  - mpi-operator
  - flux

### 🔧 환경 설정 관리
- 외부 IP 설정
- NFS 서버 구성
- 오프라인 레지스트리 설정 (오프라인 모드)
- 설정 검증 및 자동 저장

### 📊 시스템 상태 모니터링
- 실시간 환경 설정 상태 확인
- Kubernetes 클러스터 접근성 확인
- 애플리케이션 설치 상태 조회

## 🚀 시작하기

### 1. 초기 설정 및 실행

```bash
# GUI 인스톨러 실행
./run_gui_installer.sh
```

실행 시 다음 단계가 자동으로 진행됩니다:

1. **시스템 요구사항 검사**
   - 운영체제 호환성 확인
   - 필수 패키지 존재 여부 검사
   - 디스크 공간 확인

2. **설치 모드 선택**
   - 온라인 설치: 인터넷 연결 필요
   - 오프라인 설치: 사전 준비된 패키지 사용

3. **환경 구성**
   - Python 가상환경 설정
   - 시스템 의존성 설치
   - Kubernetes 도구 설치

4. **GUI 인스톨러 시작**

### 2. 기본 사용 흐름

#### 📋 1단계: 환경 설정
1. **Astrago 애플리케이션** → **환경 설정** 선택
2. 필요 정보 입력:
   - 외부 IP 주소
   - NFS 서버 IP 주소
   - NFS 기본 경로
   - (오프라인 모드) 오프라인 레지스트리 및 HTTP 서버

#### ☸️ 2단계: Kubernetes 클러스터 설정
1. **Kubernetes 클러스터** → **노드 설정** 선택
2. 노드 추가:
   - 노드 이름 (Kubernetes 표준 준수)
   - IP 주소
   - 역할 선택 (Master/Worker)
   - Etcd 클러스터 참여 여부

#### 🔧 3단계: Kubernetes 설치
1. **Kubernetes 클러스터** → **Kubernetes 설치** 선택
2. SSH 인증 정보 입력
3. 설치 진행 상황 실시간 모니터링

#### 🚀 4단계: Astrago 애플리케이션 설치
1. **Astrago 애플리케이션** → **Astrago 설치** 선택
2. 설치 확인 및 진행

## 🔧 상세 기능 가이드

### 오프라인 모드 사용법

#### 1. 오프라인 패키지 준비 (온라인 환경에서)
```bash
# 모드 선택 시 "오프라인 설치" 선택
./run_gui_installer.sh
```

GUI에서 **Astrago 애플리케이션** → **오프라인 패키지 준비** 선택

#### 2. 오프라인 환경으로 패키지 이전
준비된 패키지를 오프라인 환경으로 복사

#### 3. 오프라인 환경에서 설치
오프라인 환경에서 GUI 인스톨러 실행 후 "오프라인 설치" 모드 선택

### 개별 애플리케이션 관리

특정 애플리케이션만 설치/제거하려면:
1. **Astrago 애플리케이션** → **개별 애플리케이션 관리**
2. 대상 애플리케이션 선택
3. 설치 또는 제거 선택

### 시스템 상태 확인

**시스템 상태 확인** 메뉴에서 다음 정보를 확인할 수 있습니다:
- 설치 모드 (온라인/오프라인)
- 환경 설정 상태
- 노드 구성 정보
- Kubernetes 클러스터 접근성
- 설치된 애플리케이션 목록

## 🎨 UI 가이드

### 네비게이션
- **↑↓ 화살표**: 메뉴 이동
- **Enter**: 선택
- **ESC**: 이전 메뉴로 돌아가기
- **숫자 키**: 직접 메뉴 선택

### 상태 표시
- **✅**: 완료된 작업
- **❌**: 오류 또는 미완료
- **⚠️**: 경고
- **🔒**: 오프라인 모드
- **🌐**: 온라인 모드

### 색상 코딩
- **녹색**: 선택된 항목, 성공 메시지
- **빨간색**: 오류 메시지
- **노란색**: 경고 메시지, 오프라인 모드

## 🔍 문제 해결

### 일반적인 문제

#### 1. Python 버전 오류
```
Python 3.9+ not found
```
**해결방법**: 시스템에 Python 3.9 이상 설치

#### 2. 권한 오류
```
Permission denied
```
**해결방법**: sudo 권한으로 실행 또는 파일 권한 확인

#### 3. 네트워크 연결 오류 (온라인 모드)
```
Failed to download packages
```
**해결방법**: 인터넷 연결 확인 또는 오프라인 모드 사용

#### 4. SSH 연결 실패
```
SSH connection failed
```
**해결방법**: 
- SSH 사용자명/비밀번호 확인
- 대상 노드 네트워크 연결 확인
- SSH 서비스 상태 확인

### 로그 확인

설치 중 문제 발생 시 다음 위치에서 로그 확인:
- Kubespray 로그: `kubespray/inventory/mycluster/`
- Ansible 로그: `/tmp/ansible.log`
- 애플리케이션 로그: Kubernetes 클러스터 내

## 📚 고급 사용법

### 수동 설정 편집

필요시 다음 파일을 직접 편집할 수 있습니다:
- `environments/astrago/values.yaml`: 환경 설정
- `nodes.yaml`: 노드 구성
- `nfs-servers.yaml`: NFS 서버 설정

### CLI 모드 사용

GUI 대신 CLI 스크립트 직접 사용:
```bash
# 환경 설정
./deploy_astrago_unified.sh env

# 클러스터 설치
./deploy_astrago_unified.sh cluster

# 애플리케이션 설치
./deploy_astrago_unified.sh sync

# 상태 확인
./deploy_astrago_unified.sh status
```

## 🤝 지원

문제가 발생하거나 추가 도움이 필요한 경우:
1. 시스템 상태 확인으로 현재 상태 파악
2. 로그 파일 확인
3. 설정 파일 검증
4. 필요시 초기 설정부터 다시 시작

## 📝 라이선스

이 프로젝트는 적절한 라이선스 하에 배포됩니다.